<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Feature Testing Setup &mdash; behave 1.2.6.dev0 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.6.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="behave 1.2.6.dev0 documentation" href="index.html" />
    <link rel="next" title="Using behave" href="behave.html" />
    <link rel="prev" title="Behavior Driven Development" href="philosophy.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="behave.html" title="Using behave"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="philosophy.html" title="Behavior Driven Development"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">behave 1.2.6.dev0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="feature-testing-setup">
<h1>Feature Testing Setup<a class="headerlink" href="#feature-testing-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="feature-testing-layout">
<h2>Feature Testing Layout<a class="headerlink" href="#feature-testing-layout" title="Permalink to this headline">¶</a></h2>
<p><em>behave</em> works with three types of files:</p>
<ol class="arabic simple">
<li><a class="reference external" href="#gherkin-feature-testing-language">feature files</a> written by your Business Analyst / Sponsor / whoever
with your behaviour scenarios in it, and</li>
<li>a &#8220;steps&#8221; directory with <a class="reference external" href="tutorial.html#python-step-implementations">Python step implementations</a> for the
scenarios.</li>
<li>optionally some <a class="reference external" href="tutorial.html#environmental-controls">environmental controls</a> (code to run before and after
steps, scenarios, features or the whole shooting match).</li>
</ol>
<p>These files are typically stored in a directory called &#8220;features&#8221;. The
minimum requirement for a features directory is:</p>
<div class="highlight-python"><div class="highlight"><pre>features/
features/everything.feature
features/steps/
features/steps/steps.py
</pre></div>
</div>
<p>A more complex directory might look like:</p>
<div class="highlight-python"><div class="highlight"><pre>features/
features/signup.feature
features/login.feature
features/account_details.feature
features/environment.py
features/steps/
features/steps/website.py
features/steps/utils.py
</pre></div>
</div>
<div class="section" id="layout-variations">
<h3>Layout Variations<a class="headerlink" href="#layout-variations" title="Permalink to this headline">¶</a></h3>
<p><em>behave</em> has some flexibility built in. It will actually try quite hard to
find feature specifications. When launched you may pass on the command
line:</p>
<dl class="docutils">
<dt><strong>nothing</strong></dt>
<dd>In the absence of any information <em>behave</em> will attempt to load your
features from a subdirectory called &#8220;features&#8221; in the directory you launched
<em>behave</em>.</dd>
<dt><strong>a features directory path</strong></dt>
<dd>This is the path to a features directory laid out as described above. It may be called
anything by <em>must</em> contain at least one &#8220;<em>name</em>.feature&#8221; file and a directory
called &#8220;steps&#8221;. The &#8220;environment.py&#8221; file, if present, must be in the same
directory that contains the &#8220;steps&#8221; directory (not <em>in</em> the &#8220;steps&#8221;
directory).</dd>
<dt><strong>the path to a &#8220;*name*.feature&#8221; file</strong></dt>
<dd>This tells <em>behave</em> where to find the feature file. To find the steps
directory <em>behave</em> will look in the directory containing the feature
file. If it is not present, <em>behave</em> will look in the parent directory,
and then its parent, and so on until it hits the root of the filesystem.
The &#8220;environment.py&#8221; file, if present, must be in the same directory
that contains the &#8220;steps&#8221; directory (not <em>in</em> the &#8220;steps&#8221; directory).</dd>
<dt><strong>a directory containing your feature files</strong></dt>
<dd><p class="first">Similar to the approach above, you&#8217;re identifying the directory where your
&#8220;<em>name</em>.feature&#8221; files are, and if the &#8220;steps&#8221; directory is not in the
same place then <em>behave</em> will search for it just like above. This allows
you to have a layout like:</p>
<div class="highlight-python"><div class="highlight"><pre>tests/
tests/environment.py
tests/features/signup.feature
tests/features/login.feature
tests/features/account_details.feature
tests/steps/
tests/steps/website.py
tests/steps/utils.py
</pre></div>
</div>
<p class="last">Note that with this approach, if you want to execute <em>behave</em> without having
to explicitly specify the directory (first option) you can set the <tt class="docutils literal"><span class="pre">paths</span></tt>
setting in your <a class="reference external" href="behave.html#configuration-files">configuration file</a> (e.g. <tt class="docutils literal"><span class="pre">paths=tests</span></tt>).</p>
</dd>
</dl>
<p>If you&#8217;re having trouble setting things up and want to see what <em>behave</em> is
doing in attempting to find your features use the &#8220;-v&#8221; (verbose)
command-line switch.</p>
</div>
</div>
<div class="section" id="gherkin-feature-testing-language">
<span id="chapter-gherkin"></span><h2>Gherkin: Feature Testing Language<a class="headerlink" href="#gherkin-feature-testing-language" title="Permalink to this headline">¶</a></h2>
<p><em>behave</em> <a class="reference internal" href="#features">features</a> are written using a language called <a class="reference external" href="https://github.com/cucumber/cucumber/wiki/Gherkin">Gherkin</a> (with
<a class="reference external" href="#modifications-to-the-gherkin-standard">some modifications</a>) and are named &#8220;<em>name</em>.feature&#8221;.</p>
<p>These files should be written using natural language - ideally by the
non-technical business participants in the software project. Feature files
serve two purposes – documentation and automated tests.</p>
<p>It is very flexible but has a few simple rules that writers need to adhere to.</p>
<p>Line endings terminate statements (eg, steps). Either spaces or tabs may be
used for indentation (but spaces are more portable). Indentation is almost
always ignored - it&#8217;s a tool for the feature writer to express some
structure in the text. Most lines start with a keyword (&#8220;Feature&#8221;,
&#8220;Scenario&#8221;, &#8220;Given&#8221;, ...)</p>
<p>Comment lines are allowed anywhere in the file. They begin with zero or
more spaces, followed by a sharp sign (#) and some amount of text.</p>
<div class="section" id="features">
<h3>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h3>
<p>Features are composed of scenarios. They may optionally have a description,
a background and a set of tags. In its simplest form a feature looks like:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> feature name</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> some scenario</span>
<span class="k">      Given </span><span class="nf">some condition</span>
<span class="nf">       </span><span class="k">Then </span><span class="nf">some result is expected.</span>
</pre></div>
</div>
<p>In all its glory it could look like:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="nt">@tags</span><span class="nf"> </span><span class="nt">@tag</span><span class="nf"></span>
<span class="k">Feature:</span><span class="nf"> feature name</span>
<span class="nf">  description</span>
<span class="nf">  further description</span>

<span class="nf">  </span><span class="k">Background:</span><span class="nf"> some requirement of this test</span>
<span class="k">    Given </span><span class="nf">some setup condition</span>
<span class="nf">      </span><span class="k">And </span><span class="nf">some other setup action</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> some scenario</span>
<span class="k">      Given </span><span class="nf">some condition</span>
<span class="nf">       </span><span class="k">When </span><span class="nf">some action is taken</span>
<span class="nf">       </span><span class="k">Then </span><span class="nf">some result is expected.</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> some other scenario</span>
<span class="k">      Given </span><span class="nf">some other condition</span>
<span class="nf">       </span><span class="k">When </span><span class="nf">some action is taken</span>
<span class="nf">       </span><span class="k">Then </span><span class="nf">some other result is expected.</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> ...</span>
</pre></div>
</div>
<p>The feature name should just be some reasonably descriptive title for the
feature being tested, like &#8220;the message posting interface&#8221;. The following
description is optional and serves to clarify any potential confusion or
scope issue in the feature name. The description is for the benefit of
humans reading the feature text.</p>
<p>The Background part and the Scenarios will be discussed in the following sections.</p>
</div>
<div class="section" id="background">
<h3>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<p>A background consists of a series of steps similar to <a class="reference internal" href="#scenarios">scenarios</a>.
It allows you to add some context to the scenarios of a feature.
A background is executed before each scenario of this feature but after any
of the before hooks. It is useful for performing setup operations like:</p>
<blockquote>
<div><ul class="simple">
<li>logging into a web browser or</li>
<li>setting up a database</li>
</ul>
</div></blockquote>
<p>with test data used by the scenarios.</p>
<p>The background description is for the benefit of humans reading the feature text.
Again the background name should just be a reasonably descriptive title
for the background operation being performed or requirement being met.</p>
<p>A background section may exist only once within a feature file.
In addition, a background must be defined before any scenario or
scenario outline.</p>
<p>It contains <a class="reference internal" href="#steps">steps</a> as described below.</p>
<p><strong>Good practices for using Background</strong></p>
<dl class="docutils">
<dt>Don’t use &#8220;Background&#8221; to set up complicated state unless that state is actually something the client needs to know.</dt>
<dd>For example, if the user and site names don’t matter to the client, you
should use a high-level step such as &#8220;Given that I am logged in as a site
owner&#8221;.</dd>
<dt>Keep your &#8220;Background&#8221; section short.</dt>
<dd>You’re expecting the user to actually remember this stuff when reading
your scenarios. If the background is more than 4 lines long, can you move
some of the irrelevant details into high-level steps? See <a class="reference external" href="api.html#calling-steps-from-other-steps">calling steps
from other steps</a>.</dd>
<dt>Make your &#8220;Background&#8221; section vivid.</dt>
<dd>You should use colorful names and try to tell a story, because the human
brain can keep track of stories much better than it can keep track of
names like &#8220;User A&#8221;, &#8220;User B&#8221;, &#8220;Site 1&#8221;, and so on.</dd>
<dt>Keep your scenarios short, and don’t have too many.</dt>
<dd>If the background section has scrolled off the screen, you should think
about using higher-level steps, or splitting the features file in two.</dd>
</dl>
</div>
<div class="section" id="scenarios">
<h3>Scenarios<a class="headerlink" href="#scenarios" title="Permalink to this headline">¶</a></h3>
<p>Scenarios describe the discrete behaviours being tested. They are given a
title which should be a reasonably descriptive title for the scenario being
tested. The scenario description is for the benefit of humans reading the
feature text.</p>
<p>Scenarios are composed of a series of <a class="reference internal" href="#steps">steps</a> as described below. The
steps typically take the form of &#8220;given some condition&#8221; &#8220;then we expect
some test will pass.&#8221; In this simplest form, a scenario might be:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> we have some stock when we open the store</span>
<span class="k">  Given </span><span class="nf">that the store has just opened</span>
<span class="nf">   then we should have items for sale.</span>
</pre></div>
</div>
<p>There may be additional conditions imposed on the scenario, and these would
take the form of &#8220;when&#8221; steps following the initial &#8220;given&#8221; condition. If
necessary, additional &#8220;and&#8221; or &#8220;but&#8221; steps may also follow the &#8220;given&#8221;,
&#8220;when&#8221; and &#8220;then&#8221; steps if more needs to be tested. A more complex example
of a scenario might be:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> Replaced items should be returned to stock</span>
<span class="k">  Given </span><span class="nf">that a customer buys a blue garment</span>
<span class="nf">    and I have two blue garments in stock</span>
<span class="nf">    but I have no red garments in stock</span>
<span class="nf">    and three black garments in stock.</span>
<span class="nf">   </span><span class="k">When </span><span class="nf">he returns the garment for a replacement in black,</span>
<span class="nf">   then I should have three blue garments in stock</span>
<span class="nf">    and no red garments in stock,</span>
<span class="nf">    and two black garments in stock.</span>
</pre></div>
</div>
<p>It is good practise to have a scenario test only one behaviour or desired
outcome.</p>
<p>Scenarios contain <a class="reference internal" href="#steps">steps</a> as described below.</p>
</div>
<div class="section" id="scenario-outlines">
<h3>Scenario Outlines<a class="headerlink" href="#scenario-outlines" title="Permalink to this headline">¶</a></h3>
<p>These may be used when you have a set of expected conditions and outcomes
to go along with your scenario <a class="reference internal" href="#steps">steps</a>.</p>
<p>An outline includes keywords in the step definitions which are filled in
using values from example tables. You may have a number of example tables
in each scenario outline.</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario Outline:</span><span class="nf"> Blenders</span>
<span class="k">   Given </span><span class="nf">I put </span><span class="nv">&lt;thing&gt;</span><span class="nf"> in a blender,</span>
<span class="nf">    when I switch the blender on</span>
<span class="nf">    then it should transform into </span><span class="nv">&lt;other thing&gt;</span><span class="nf"></span>

<span class="nf"> </span><span class="k">Examples:</span><span class="nf"> Amphibians</span><span class="k"></span>
<span class="k">   |</span><span class="nv"> thing</span><span class="k">         |</span><span class="nv"> other thing</span><span class="k"> |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Red Tree Frog</span><span class="k"> |</span><span class="s"> mush</span><span class="k">        |</span>

<span class="nf"> </span><span class="k">Examples:</span><span class="nf"> Consumer Electronics</span><span class="k"></span>
<span class="k">   |</span><span class="nv"> thing</span><span class="k">         |</span><span class="nv"> other thing</span><span class="k"> |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> iPhone</span><span class="k">        |</span><span class="s"> toxic waste</span><span class="k"> |</span><span class="nf"></span>
<span class="k">   |</span><span class="s"> Galaxy Nexus</span><span class="k">  |</span><span class="s"> toxic waste</span><span class="k"> |</span>
</pre></div>
</div>
<p><em>behave</em> will run the scenario once for each (non-heading) line appearing
in the example data tables.</p>
<p>The values to replace are determined using the name appearing in the angle
brackets &#8220;&lt;<em>name</em>&gt;&#8221; which must match a headings of the example tables. The
name may include almost any character, though not the close angle bracket
&#8220;&gt;&#8221;.</p>
<p>Substitution may also occur in <a class="reference internal" href="#step-data">step data</a> if the &#8220;&lt;<em>name</em>&gt;&#8221; texts appear
within the step data text or table cells.</p>
</div>
<div class="section" id="steps">
<h3>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h3>
<p>Steps take a line each and begin with a <em>keyword</em> - one of &#8220;given&#8221;, &#8220;when&#8221;,
&#8220;then&#8221;, &#8220;and&#8221; or &#8220;but&#8221;.</p>
<p>In a formal sense the keywords are all Title Case, though some languages
allow all-lowercase keywords where that makes sense.</p>
<p>Steps should not need to contain significant degree of detail about the
mechanics of testing; that is, instead of:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Given </span><span class="nf">a browser client is used to load the URL &quot;</span><span class="s">http://website.example/website/home.html</span><span class="nf">&quot;</span>
</pre></div>
</div>
<p>the step could instead simply say:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Given </span><span class="nf">we are looking at the home page</span>
</pre></div>
</div>
<p>Steps are implemented using Python code which is implemented in the &#8220;steps&#8221;
directory in Python modules (files with Python code which are named
&#8220;<em>name</em>.py&#8221;.) The naming of the Python modules does not matter. <em>All</em> modules
in the &#8220;steps&#8221; directory will be imported by <em>behave</em> at startup to
discover the step implementations.</p>
<div class="section" id="given-when-then-and-but">
<h4>Given, When, Then (And, But)<a class="headerlink" href="#given-when-then-and-but" title="Permalink to this headline">¶</a></h4>
<p><em>behave</em> doesn&#8217;t technically distinguish between the various kinds of steps.
However, we strongly recommend that you do! These words have been carefully
selected for their purpose, and you should know what the purpose is to get
into the BDD mindset.</p>
<div class="section" id="given">
<h5>Given<a class="headerlink" href="#given" title="Permalink to this headline">¶</a></h5>
<p>The purpose of givens is to <strong>put the system in a known state</strong> before the
user (or external system) starts interacting with the system (in the When
steps). Avoid talking about user interaction in givens.  If you had worked
with usecases, you would call this preconditions.</p>
<p>Examples:</p>
<ul class="simple">
<li>Create records (model instances) / set up the database state.</li>
<li>It&#8217;s ok to call directly into your application model here.</li>
<li>Log in a user (An exception to the no-interaction recommendation. Things
that &#8220;happened earlier&#8221; are ok).</li>
</ul>
<p>You might also use Given with a multiline table argument to set up database
records instead of fixtures hard-coded in steps. This way you can read
the scenario and make sense out of it without having to look elsewhere (at
the fixtures).</p>
</div>
<div class="section" id="when">
<h5>When<a class="headerlink" href="#when" title="Permalink to this headline">¶</a></h5>
<p>Each of these steps should <strong>describe the key action</strong> the user (or
external system) performs. This is the interaction with your system which
should (or perhaps should not) cause some state to change.</p>
<p>Examples:</p>
<ul class="simple">
<li>Interact with a web page (<a class="reference external" href="http://docs.python-requests.org/en/latest/">Requests</a>/<a class="reference external" href="http://twill.idyll.org/">Twill</a>/<a class="reference external" href="http://docs.seleniumhq.org/projects/webdriver/">Selenium</a> <em>interaction</em>
etc   should mostly go into When steps).</li>
<li>Interact with some other user interface element.</li>
<li>Developing a library? Kicking off some kind of action that has an
observable effect somewhere else.</li>
</ul>
</div>
<div class="section" id="then">
<h5>Then<a class="headerlink" href="#then" title="Permalink to this headline">¶</a></h5>
<p>Here we <strong>observe outcomes</strong>. The observations should be related to the
business value/benefit in your feature description. The observations should
also be on some kind of <em>output</em> - that is something that comes <em>out</em> of
the system (report, user interface, message) and not something that is
deeply buried inside it (that has no business value).</p>
<p>Examples:</p>
<ul class="simple">
<li>Verify that something related to the Given+When is (or is not) in the output</li>
<li>Check that some external system has received the expected message (was an
email with specific content sent?)</li>
</ul>
<p>While it might be tempting to implement Then steps to just look in the
database - resist the temptation. You should only verify outcome that is
observable for the user (or external system) and databases usually are not.</p>
</div>
<div class="section" id="and-but">
<h5>And, But<a class="headerlink" href="#and-but" title="Permalink to this headline">¶</a></h5>
<p>If you have several givens, whens or thens you could write:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> Multiple Givens</span>
<span class="k">  Given </span><span class="nf">one thing</span>
<span class="nf">  </span><span class="k">Given </span><span class="nf">an other thing</span>
<span class="nf">  </span><span class="k">Given </span><span class="nf">yet an other thing</span>
<span class="nf">   </span><span class="k">When </span><span class="nf">I open my eyes</span>
<span class="nf">   </span><span class="k">Then </span><span class="nf">I see something</span>
<span class="nf">   </span><span class="k">Then </span><span class="nf">I don&#39;t see something else</span>
</pre></div>
</div>
<p>Or you can make it read more fluently by writing:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> Multiple Givens</span>
<span class="k">  Given </span><span class="nf">one thing</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">an other thing</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">yet an other thing</span>
<span class="nf">   </span><span class="k">When </span><span class="nf">I open my eyes</span>
<span class="nf">   </span><span class="k">Then </span><span class="nf">I see something</span>
<span class="nf">    </span><span class="k">But </span><span class="nf">I don&#39;t see something else</span>
</pre></div>
</div>
<p>The two scenarios are identical to <em>behave</em> - steps beginning with &#8220;and&#8221; or
&#8220;but&#8221; are exactly the same kind of steps as all the others. They simply
mimic the step that preceeds them.</p>
</div>
</div>
<div class="section" id="step-data">
<h4>Step Data<a class="headerlink" href="#step-data" title="Permalink to this headline">¶</a></h4>
<p>Steps may have some text or a table of data attached to them.</p>
<p>Substitution of scenario outline values will be done in step data text or
table data if the &#8220;&lt;<em>name</em>&gt;&#8221; texts appear within the step data text or
table cells.</p>
<div class="section" id="text">
<h5>Text<a class="headerlink" href="#text" title="Permalink to this headline">¶</a></h5>
<p>Any text block following a step wrapped in <tt class="docutils literal"><span class="pre">&quot;&quot;&quot;</span></tt> lines will be associated
with the step.  This is the one case where indentation is actually parsed:
the leading whitespace is stripped from the text, and successive lines of
the text should have at least the same amount of whitespace as the first
line.</p>
<p>So for this rather contrived example:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> some scenario</span>
<span class="k">  Given </span><span class="nf">a sample text loaded into the frobulator</span>
<span class="nf">     </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">     Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do</span>
<span class="s">     eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut</span>
<span class="s">     enim ad minim veniam, quis nostrud exercitation ullamco laboris</span>
<span class="s">     nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in</span>
<span class="s">     reprehenderit in voluptate velit esse cillum dolore eu fugiat</span>
<span class="s">     nulla pariatur. Excepteur sint occaecat cupidatat non proident,</span>
<span class="s">     sunt in culpa qui officia deserunt mollit anim id est laborum.</span>
<span class="s">     </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="nf"> </span><span class="k">When </span><span class="nf">we activate the frobulator</span>
<span class="nf"> </span><span class="k">Then </span><span class="nf">we will find it similar to English</span>
</pre></div>
</div>
<p>The text is available to the Python step code as the &#8221;.text&#8221; attribute
in the <a class="reference internal" href="api.html#behave.runner.Context" title="behave.runner.Context"><tt class="xref py py-class docutils literal"><span class="pre">Context</span></tt></a> variable passed into each step
function. The text supplied on the first step in a scenario will be
available on the context variable for the duration of that scenario. Any
further text present on a subsequent step will overwrite previously-set
text.</p>
</div>
<div class="section" id="table">
<h5>Table<a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h5>
<p>You may associate a table of data with a step by simply entering it,
indented, following the step. This can be useful for loading specific
required data into a model.</p>
<p>The table formatting doesn&#8217;t have to be strictly lined up but it does need
to have the same number of columns on each line. A column is anything
appearing between two vertical bars &#8220;|&#8221;. Any whitespace between the column
content and the vertical bar is removed.</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Scenario:</span><span class="nf"> some scenario</span>
<span class="k">  Given </span><span class="nf">a set of specific users</span>
<span class="k">     |</span><span class="s"> name</span><span class="k">      |</span><span class="s"> department</span><span class="k">  |</span><span class="nf"></span>
<span class="k">     |</span><span class="s"> Barry</span><span class="k">     |</span><span class="s"> Beer Cans</span><span class="k">   |</span><span class="nf"></span>
<span class="k">     |</span><span class="s"> Pudey</span><span class="k">     |</span><span class="s"> Silly Walks</span><span class="k"> |</span><span class="nf"></span>
<span class="k">     |</span><span class="s"> Two-Lumps</span><span class="k"> |</span><span class="s"> Silly Walks</span><span class="k"> |</span>

<span class="nf"> </span><span class="k">When </span><span class="nf">we count the number of people in each department</span>
<span class="nf"> </span><span class="k">Then </span><span class="nf">we will find two people in &quot;</span><span class="s">Silly Walks</span><span class="nf">&quot;</span>
<span class="nf">  </span><span class="k">But </span><span class="nf">we will find one person in &quot;</span><span class="s">Beer Cans</span><span class="nf">&quot;</span>
</pre></div>
</div>
<p>The table is available to the Python step code as the &#8221;.table&#8221; attribute
in the <a class="reference internal" href="api.html#behave.runner.Context" title="behave.runner.Context"><tt class="xref py py-class docutils literal"><span class="pre">Context</span></tt></a> variable passed into each step
function. The table is an instance of <a class="reference internal" href="api.html#behave.model.Table" title="behave.model.Table"><tt class="xref py py-class docutils literal"><span class="pre">Table</span></tt></a> and
for the example above could be accessed like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@given</span><span class="p">(</span><span class="s">&#39;a set of specific users&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_impl</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add_user</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">],</span> <span class="n">department</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s">&#39;department&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>There&#8217;s a variety of ways to access the table data - see the
<a class="reference internal" href="api.html#behave.model.Table" title="behave.model.Table"><tt class="xref py py-class docutils literal"><span class="pre">Table</span></tt></a> API documentation for the full details.</p>
</div>
</div>
</div>
<div class="section" id="tags">
<h3>Tags<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<p>You may also &#8220;tag&#8221; parts of your feature file. At the simplest level this
allows <em>behave</em> to selectively check parts of your feature set.</p>
<p>You may tag features, scenarios or scenario outlines but nothing else.
Any tag that exists in a feature will be inherited by its scenarios and
scenario outlines.</p>
<p>Tags appear on the line preceding the feature or scenario you wish to tag.
You may have many space-separated tags on a single line.</p>
<p>A tag takes the form of the at symbol &#8220;&#64;&#8221; followed by a word (which may
include underscores &#8220;_&#8221;). Valid tag lines include:</p>
<div class="highlight-python"><div class="highlight"><pre>@slow
@wip
@needs_database @slow
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="nt">@wip</span><span class="nf"> </span><span class="nt">@slow</span><span class="nf"></span>
<span class="k">Feature:</span><span class="nf"> annual reporting</span>
<span class="nf">  Some description of a slow reporting system.</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="nt">@wip</span><span class="nf"></span>
<span class="nt">@slow</span><span class="nf"></span>
<span class="k">Feature:</span><span class="nf"> annual reporting</span>
<span class="nf">  Some description of a slow reporting system.</span>
</pre></div>
</div>
<p>Tags may be used to <a class="reference external" href="#controlling-your-test-run-with-tags">control your test run</a> by only including certain
features or scenarios based on tag selection. The tag information may also
be accessed from the <a class="reference external" href="#accessing-tag-information-in-python">Python code backing up the tests</a>.</p>
<div class="section" id="controlling-your-test-run-with-tags">
<h4>Controlling Your Test Run With Tags<a class="headerlink" href="#controlling-your-test-run-with-tags" title="Permalink to this headline">¶</a></h4>
<p>Given a feature file with:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Fight or flight</span>
<span class="nf">  In order to increase the ninja survival rate,</span>
<span class="nf">  As a ninja commander</span>
<span class="nf">  I want my ninjas to decide whether to take on an</span>
<span class="nf">  opponent based on their skill levels</span>

<span class="nf">  @slow</span>
<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Weaker opponent</span>
<span class="k">    Given </span><span class="nf">the ninja has a third level black-belt</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">attacked by a samurai</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">the ninja should engage the opponent</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Stronger opponent</span>
<span class="k">    Given </span><span class="nf">the ninja has a third level black-belt</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">attacked by Chuck Norris</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">the ninja should run for his life</span>
</pre></div>
</div>
<p>then running <tt class="docutils literal"><span class="pre">behave</span> <span class="pre">--tags=slow</span></tt> will run just the scenarios tagged
<tt class="docutils literal"><span class="pre">&#64;slow</span></tt>. If you wish to check everything <em>except</em> the slow ones then you
may run <tt class="docutils literal"><span class="pre">behave</span> <span class="pre">--tags=-slow</span></tt>.</p>
<p>Another common use-case is to tag a scenario you&#8217;re working on with
<tt class="docutils literal"><span class="pre">&#64;wip</span></tt> and then <tt class="docutils literal"><span class="pre">behave</span> <span class="pre">--tags=wip</span></tt> to just test that one case.</p>
<p>Tag selection on the command-line may be combined:</p>
<dl class="docutils">
<dt><strong>&#8211;tags=wip,slow</strong></dt>
<dd>This will select all the cases tagged <em>either</em> &#8220;wip&#8221; or &#8220;slow&#8221;.</dd>
<dt><strong>&#8211;tags=wip &#8211;tags=slow</strong></dt>
<dd>This will select all the cases tagged <em>both</em> &#8220;wip&#8221; and &#8220;slow&#8221;.</dd>
</dl>
<p>If a feature or scenario is tagged and then skipped because of a
command-line control then the <em>before_</em> and <em>after_</em> environment functions
will not be called for that feature or scenario.</p>
</div>
<div class="section" id="accessing-tag-information-in-python">
<h4>Accessing Tag Information In Python<a class="headerlink" href="#accessing-tag-information-in-python" title="Permalink to this headline">¶</a></h4>
<p>The tags attached to a feature and scenario are available in
the environment functions via the &#8220;feature&#8221; or &#8220;scenario&#8221; object passed to
them. On those objects there is an attribute called &#8220;tags&#8221; which is a list
of the tag names attached, in the order they&#8217;re found in the features file.</p>
<p>There are also <a class="reference external" href="tutorial.html#environmental-controls">environmental controls</a> specific to tags, so in the above
example <em>behave</em> will attempt to invoke an <tt class="docutils literal"><span class="pre">environment.py</span></tt> function
<tt class="docutils literal"><span class="pre">before_tag</span></tt> and <tt class="docutils literal"><span class="pre">after_tag</span></tt> before and after the Scenario tagged
<tt class="docutils literal"><span class="pre">&#64;slow</span></tt>, passing in the name &#8220;slow&#8221;. If multiple tags are present then
the functions will be called multiple times with each tag in the order
they&#8217;re defined in the feature file.</p>
<p>Re-visiting the example from above; if only some of the features required a
browser and web server then you could tag them <tt class="docutils literal"><span class="pre">&#64;browser</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">before_feature</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">feature</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">&#39;browser&#39;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="n">context</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">simple_server</span><span class="o">.</span><span class="n">WSGIServer</span><span class="p">((</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">))</span>
        <span class="n">context</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">set_app</span><span class="p">(</span><span class="n">web_app</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">))</span>
        <span class="n">context</span><span class="o">.</span><span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">after_feature</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">feature</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">&#39;browser&#39;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="n">context</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="languages-other-than-english">
<h3>Languages Other Than English<a class="headerlink" href="#languages-other-than-english" title="Permalink to this headline">¶</a></h3>
<p>English is the default language used in parsing feature files. If you wish
to use a different language you should check to see whether it is
available:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">behave</span> <span class="o">--</span><span class="n">lang</span><span class="o">-</span><span class="nb">list</span>
</pre></div>
</div>
<p>This command lists all the supported languages. If yours is present then
you have two options:</p>
<ol class="arabic">
<li><p class="first">add a line to the top of the feature files like (for French):</p>
<blockquote>
<div><p># language: fr</p>
</div></blockquote>
</li>
<li><p class="first">use the command-line switch <tt class="docutils literal"><span class="pre">--lang</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">behave</span> <span class="o">--</span><span class="n">lang</span><span class="o">=</span><span class="n">fr</span>
</pre></div>
</div>
</li>
</ol>
<p>The feature file keywords will now use the French translations. To see what
the language equivalents recognised by <em>behave</em> are, use:</p>
<div class="highlight-python"><div class="highlight"><pre>behave --lang-help fr
</pre></div>
</div>
</div>
<div class="section" id="modifications-to-the-gherkin-standard">
<h3>Modifications to the Gherkin Standard<a class="headerlink" href="#modifications-to-the-gherkin-standard" title="Permalink to this headline">¶</a></h3>
<p><em>behave</em> can parse standard Gherkin files and extends Gherkin to allow
lowercase step keywords because these can sometimes allow more readable
feature specifications.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/behave_logo1.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Feature Testing Setup</a><ul>
<li><a class="reference internal" href="#feature-testing-layout">Feature Testing Layout</a><ul>
<li><a class="reference internal" href="#layout-variations">Layout Variations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gherkin-feature-testing-language">Gherkin: Feature Testing Language</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#scenarios">Scenarios</a></li>
<li><a class="reference internal" href="#scenario-outlines">Scenario Outlines</a></li>
<li><a class="reference internal" href="#steps">Steps</a><ul>
<li><a class="reference internal" href="#given-when-then-and-but">Given, When, Then (And, But)</a><ul>
<li><a class="reference internal" href="#given">Given</a></li>
<li><a class="reference internal" href="#when">When</a></li>
<li><a class="reference internal" href="#then">Then</a></li>
<li><a class="reference internal" href="#and-but">And, But</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-data">Step Data</a><ul>
<li><a class="reference internal" href="#text">Text</a></li>
<li><a class="reference internal" href="#table">Table</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tags">Tags</a><ul>
<li><a class="reference internal" href="#controlling-your-test-run-with-tags">Controlling Your Test Run With Tags</a></li>
<li><a class="reference internal" href="#accessing-tag-information-in-python">Accessing Tag Information In Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#languages-other-than-english">Languages Other Than English</a></li>
<li><a class="reference internal" href="#modifications-to-the-gherkin-standard">Modifications to the Gherkin Standard</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="philosophy.html" title="previous chapter">Behavior Driven Development</a></li>
      <li>Next: <a href="behave.html" title="next chapter">Using <em>behave</em></a></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/gherkin.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; Copyright 2012-2015, Benno Rice, Richard Jones and Jens Engel.
    </div>
    <a href="https://github.com/behave/behave" class="github">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
    </a>
  </body>
</html>